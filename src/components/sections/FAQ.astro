---
const faqs = [
    {
        question: "Is Estimio free to try?",
        answer: "Yes! Estimio is free to download and comes with a 7-day full access free trial. After that, it's just $19.99 USD ($24.99 CAD) per month - less than the profit from a single hour of work.",
    },
    {
        question: "How accurate are the material prices?",
        answer: "Our AI uses real-time local data to estimate pricing for your specific area. However, you always have full control to adjust or override any price with your own custom rates.",
    },
    {
        question: "Can I use my own logo and branding?",
        answer: "Absolutely. You can upload your company logo, set your business details, and customize the footer of every PDF proposal and invoice you send.",
    },
    {
        question: "Can I generate invoices too?",
        answer: "Yes. You can convert any estimate into a professional PDF invoice with one tap. Track payments, view outstanding balances, and get paid faster without extra paperwork.",
    },
];

// FAQ Structured Data for SEO
const faqSchema = {
    "@context": "https://schema.org",
    "@type": "FAQPage",
    mainEntity: faqs.map(faq => ({
        "@type": "Question",
        name: faq.question,
        acceptedAnswer: {
            "@type": "Answer",
            text: faq.answer
        }
    }))
};
---

<section
    id="faq"
    class="py-20 md:py-28 bg-bg-gray border-t border-separator/50"
    aria-labelledby="faq-heading"
>
    <div class="section-container max-w-4xl mx-auto">
        <div class="text-center mb-16">
            <h2
                id="faq-heading"
                class="fade-up text-3xl md:text-4xl font-semibold text-text-primary mb-4"
            >
                Frequently Asked Questions
            </h2>
            <p class="fade-up text-lg text-text-secondary">
                Everything you need to know about Estimio.
            </p>
        </div>

        <div class="space-y-4">
            {
                faqs.map((faq, index) => (
                    <div class="fade-up faq-item bg-white rounded-2xl border border-separator/50 hover:shadow-md hover:border-primary/20 transition-all duration-300 overflow-hidden group">
                        <button
                            type="button"
                            class="faq-btn w-full flex items-center justify-between p-6 md:p-8 text-left focus:outline-none"
                            aria-expanded="false"
                            aria-controls={`faq-answer-${index}`}
                            onclick="toggleFaq(this)"
                        >
                            <span class="text-xl font-semibold text-text-primary group-hover:text-primary transition-colors duration-300">
                                {faq.question}
                            </span>
                            <span class="faq-icon relative flex-shrink-0 ml-4 w-6 h-6 text-primary/50 group-hover:text-primary transition-all duration-300">
                                <svg
                                    class="w-full h-full"
                                    fill="none"
                                    viewBox="0 0 24 24"
                                    stroke="currentColor"
                                    stroke-width="2"
                                >
                                    <path
                                        stroke-linecap="round"
                                        stroke-linejoin="round"
                                        d="M19 9l-7 7-7-7"
                                    />
                                </svg>
                            </span>
                        </button>
                        <div id={`faq-answer-${index}`} class="faq-content max-h-0 overflow-hidden transition-all duration-300 ease-out" role="region" aria-hidden="true">
                            <p class="text-text-secondary leading-relaxed px-6 pb-6 md:px-8 md:pb-8 pt-0">
                                {faq.answer}
                            </p>
                        </div>
                    </div>
                ))
            }
        </div>
    </div>
</section>

<!-- FAQ Structured Data -->
<script type="application/ld+json" is:inline set:html={JSON.stringify(faqSchema)} />

<script is:inline>
    function toggleFaq(button) {
        const content = button.nextElementSibling;
        const icon = button.querySelector(".faq-icon");
        const isExpanded = button.getAttribute("aria-expanded") === "true";

        // Toggle current
        button.setAttribute("aria-expanded", !isExpanded);

        if (!isExpanded) {
            content.style.maxHeight = content.scrollHeight + "px";
            content.setAttribute("aria-hidden", "false");
            icon.style.transform = "rotate(180deg)";
            const item = button.closest(".faq-item");
            item.classList.add(
                "border-primary",
                "ring-1",
                "ring-primary/20",
                "shadow-sm",
            );
            item.classList.remove("border-separator/50");
        } else {
            content.style.maxHeight = "0";
            content.setAttribute("aria-hidden", "true");
            icon.style.transform = "rotate(0deg)";
            const item = button.closest(".faq-item");
            item.classList.remove(
                "border-primary",
                "ring-1",
                "ring-primary/20",
                "shadow-sm",
            );
            item.classList.add("border-separator/50");
        }
    }
</script>
