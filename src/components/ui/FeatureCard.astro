---
interface Props {
  title: string;
  description: string;
  image: string;
  imageAlt: string;
  icon?: 'camera' | 'location' | 'refresh' | 'chart' | 'document';
  badge?: string;
  size?: 'default' | 'large';
  index?: number;
  class?: string;
}

const {
  title,
  description,
  image,
  imageAlt,
  icon,
  badge,
  size = 'default',
  index = 0,
  class: className = '',
} = Astro.props;

const icons = {
  camera: `<svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
    <path stroke-linecap="round" stroke-linejoin="round" d="M6.827 6.175A2.31 2.31 0 015.186 7.23c-.38.054-.757.112-1.134.175C2.999 7.58 2.25 8.507 2.25 9.574V18a2.25 2.25 0 002.25 2.25h15A2.25 2.25 0 0021.75 18V9.574c0-1.067-.75-1.994-1.802-2.169a47.865 47.865 0 00-1.134-.175 2.31 2.31 0 01-1.64-1.055l-.822-1.316a2.192 2.192 0 00-1.736-1.039 48.774 48.774 0 00-5.232 0 2.192 2.192 0 00-1.736 1.039l-.821 1.316z" />
    <path stroke-linecap="round" stroke-linejoin="round" d="M16.5 12.75a4.5 4.5 0 11-9 0 4.5 4.5 0 019 0zM18.75 10.5h.008v.008h-.008V10.5z" />
  </svg>`,
  location: `<svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15 10.5a3 3 0 11-6 0 3 3 0 016 0z" />
    <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1115 0z" />
  </svg>`,
  refresh: `<svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
    <path stroke-linecap="round" stroke-linejoin="round" d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99" />
  </svg>`,
  chart: `<svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
    <path stroke-linecap="round" stroke-linejoin="round" d="M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 013 19.875v-6.75zM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 01-1.125-1.125V8.625zM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 01-1.125-1.125V4.125z" />
  </svg>`,
  document: `<svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
    <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z" />
  </svg>`,
};

const isLarge = size === 'large';
---

<article
  class:list={[
    'feature-card group relative bg-white rounded-2xl lg:rounded-3xl overflow-hidden border border-separator/50 gsap-fade-up',
    'hover:border-primary/20 transition-all duration-500',
    className,
  ]}
  style={`--index: ${index}`}
>
  <!-- Image Container -->
  <div class:list={[
    'relative overflow-hidden bg-bg-gray',
    isLarge ? 'aspect-[16/10]' : 'aspect-[4/3]'
  ]}>
    <!-- Gradient overlay on hover -->
    <div class="absolute inset-0 bg-gradient-to-t from-black/20 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-500 z-10"></div>

    <img
      src={image}
      alt={imageAlt}
      class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-105"
      loading="lazy"
      decoding="async"
    />

    <!-- Badge (optional) -->
    {badge && (
      <div class="absolute top-4 left-4 z-20">
        <span class="inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full bg-white/95 backdrop-blur-sm text-xs font-semibold text-primary shadow-sm">
          {icon && <span set:html={icons[icon]} class="w-3.5 h-3.5" />}
          {badge}
        </span>
      </div>
    )}
  </div>

  <!-- Content -->
  <div class:list={[
    'relative',
    isLarge ? 'p-6 lg:p-8' : 'p-5 lg:p-6'
  ]}>
    <!-- Icon + Title row -->
    <div class="flex items-start gap-3 mb-3">
      {icon && !badge && (
        <div class="flex-shrink-0 w-10 h-10 rounded-xl bg-primary/10 flex items-center justify-center text-primary group-hover:bg-primary group-hover:text-white transition-colors duration-300">
          <span set:html={icons[icon]} />
        </div>
      )}
      <div class="flex-1 min-w-0">
        <h3 class:list={[
          'font-semibold text-text-primary group-hover:text-primary transition-colors duration-300',
          isLarge ? 'text-xl lg:text-2xl' : 'text-lg lg:text-xl'
        ]}>
          {title}
        </h3>
      </div>
    </div>

    <!-- Description -->
    <p class:list={[
      'text-text-secondary leading-relaxed',
      isLarge ? 'text-base' : 'text-sm lg:text-base',
      icon && !badge ? 'ml-13' : ''
    ]}>
      {description}
    </p>

    <!-- Hover arrow indicator -->
    <div class="absolute bottom-5 right-5 lg:bottom-6 lg:right-6 w-8 h-8 rounded-full bg-bg-gray flex items-center justify-center text-text-tertiary opacity-0 group-hover:opacity-100 transition-all duration-300 group-hover:translate-x-1">
      <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
        <path stroke-linecap="round" stroke-linejoin="round" d="M4.5 19.5l15-15m0 0H8.25m11.25 0v11.25" />
      </svg>
    </div>
  </div>
</article>

<style>
  .feature-card {
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.04), 0 4px 12px rgba(0, 0, 0, 0.03);
  }

  .feature-card:hover {
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.06), 0 12px 40px rgba(0, 122, 255, 0.08);
    transform: translateY(-4px);
  }

  .ml-13 {
    margin-left: 3.25rem; /* 52px = 40px icon + 12px gap */
  }
</style>
